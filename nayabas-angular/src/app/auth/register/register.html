<div class="row justify-content-center mt-5">
  <div class="col-md-6">
    <form [formGroup]="form" class="card p-4 shadow" (ngSubmit)="submit()">
      <h2 class="mb-3 text-center">Register</h2>

      <!-- Role Selector -->
      <div class="mb-3">
        <label>Role</label>
        <select class="form-select" (change)="setRole($any($event.target).value)">
          <option value="CUSTOMER">Customer (Renter)</option>
          <option value="SELLER">Seller (Property Owner/Agent)</option>
        </select>
      </div>

      <!-- Common Fields -->
      <div class="mb-3">
        <label>Username</label>
        <input type="text" formControlName="username" class="form-control" />
      </div>

      <div class="mb-3">
        <label>Password</label>
        <input type="password" formControlName="password" class="form-control" />
      </div>

      <div class="mb-3">
        <label>Email</label>
        <input type="email" formControlName="email" class="form-control" />
      </div>

      <div class="mb-3">
        <label>Full Name</label>
        <input type="text" formControlName="fullName" class="form-control" />
      </div>

      <div class="mb-3">
        <label>Address</label>
        <input type="text" formControlName="addressLine1" class="form-control" />
      </div>

      <!-- Seller-specific fields -->
      <div *ngIf="role === 'SELLER'">
        <div class="mb-3">
          <label>Phone Number</label>
          <input type="text" formControlName="phoneNumber" class="form-control" />
        </div>

        <!-- ID Proof -->
        <div class="mb-3">
          <label>ID Proof</label>
          <input type="file" (change)="onFileSelect($event, 'idProof')" class="form-control"
            accept="image/*,.pdf" />
          <div *ngIf="idProof" class="mt-2">
            <small>Selected File: {{ idProof.name }}</small>
            <div class="progress mt-1">
              <div class="progress-bar bg-info" role="progressbar" [style.width.%]="uploadProgress.idProof"
                aria-valuemin="0" aria-valuemax="100">{{ uploadProgress.idProof }}%</div>
            </div>
            <img *ngIf="isImage(idProof)" [src]="idProofPreview" class="img-thumbnail mt-2" style="max-height: 120px;">
          </div>
        </div>

        <!-- House Ownership Proof -->
        <div class="mb-3">
          <label>House Ownership Proof</label>
          <input type="file" (change)="onFileSelect($event, 'houseOwnershipProof')" class="form-control"
            accept="image/*,.pdf" />
          <div *ngIf="houseOwnershipProof" class="mt-2">
            <small>Selected File: {{ houseOwnershipProof.name }}</small>
            <div class="progress mt-1">
              <div class="progress-bar bg-success" role="progressbar"
                [style.width.%]="uploadProgress.houseOwnershipProof" aria-valuemin="0" aria-valuemax="100">
                {{ uploadProgress.houseOwnershipProof }}%
              </div>
            </div>
            <img *ngIf="isImage(houseOwnershipProof)" [src]="houseOwnershipProofPreview" class="img-thumbnail mt-2"
              style="max-height: 120px;">
          </div>
        </div>
      </div>

      <!-- Submit button -->
<button 
  type="submit" 
  class="btn btn-success w-100" 
  [disabled]="loading || (role === 'SELLER' && (uploadProgress.idProof < 100 || uploadProgress.houseOwnershipProof < 100))">
  <span *ngIf="loading" class="spinner-border spinner-border-sm me-2" role="status"></span>
  Register
</button>
    </form>
  </div>
</div>